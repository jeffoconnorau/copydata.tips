<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>vSphere / ESXi 7.0 installed on your older hardware (unsupported) | Copy Data Tips</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="vSphere / ESXi 7.0 installed on your older hardware (unsupported)" /> <meta name="author" content="joconnor" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Let me preface this post by saying, this is not a supported way to get vSphere / ESXi 7.0+ running on legacy hardware. Please only perform these actions if you are comfortable with the steps below, and know that you will not be entitled to support for VMware." /> <meta property="og:description" content="Let me preface this post by saying, this is not a supported way to get vSphere / ESXi 7.0+ running on legacy hardware. Please only perform these actions if you are comfortable with the steps below, and know that you will not be entitled to support for VMware." /> <link rel="canonical" href="http://localhost:4000/2020/07/vsphere-esxi-7-0-installed-on-your-older-hardware-unsupported/" /> <meta property="og:url" content="http://localhost:4000/2020/07/vsphere-esxi-7-0-installed-on-your-older-hardware-unsupported/" /> <meta property="og:site_name" content="Copy Data Tips" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-07-02T02:13:45+10:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="vSphere / ESXi 7.0 installed on your older hardware (unsupported)" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"joconnor"},"dateModified":"2023-04-16T17:57:41+10:00","datePublished":"2020-07-02T02:13:45+10:00","description":"Let me preface this post by saying, this is not a supported way to get vSphere / ESXi 7.0+ running on legacy hardware. Please only perform these actions if you are comfortable with the steps below, and know that you will not be entitled to support for VMware.","headline":"vSphere / ESXi 7.0 installed on your older hardware (unsupported)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/07/vsphere-esxi-7-0-installed-on-your-older-hardware-unsupported/"},"url":"http://localhost:4000/2020/07/vsphere-esxi-7-0-installed-on-your-older-hardware-unsupported/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/author.html" class="nav-list-link">Author</a></li><li class="nav-list-item"><a href="/downloads.html" class="nav-list-link">Downloads</a></li><li class="nav-list-item"><a href="/home.html" class="nav-list-link">Home</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search" aria-label="Search" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <p>2020-07-02 02:13:45 +1000 - Written by joconnor</p> <p>Let me preface this post by saying, this is not a supported way to get vSphere / ESXi 7.0+ running on legacy hardware. Please only perform these actions if you are comfortable with the steps below, and know that you will not be entitled to support for VMware.</p> <p>For my example in this article, I am using an IBM M3 X3550 Series server. While this approach might also work for other vendor hardware, you may need to make some slight modifications to the process, but it should still work.</p> <p><strong><u>TL;DR</u></strong> – You basically need to do two things, 1. Install ESXi onto a USB drive, instead of local hard drives, and 2. Implement the <code class="language-plaintext highlighter-rouge">allowLegacyCPU=true</code> mode in the boot.cfg.</p> <p>Here are the list of things you need:</p> <p>1. The VMware vSphere ISO to use for the installation. I used this one I downloaded from VMware “VMware-VMvisor-Installer-7.0.0-15843807.x86_64.iso”<br /> 2. A 16Gb or larger USB flash drive. I would recommend you use something decent here. In my example. I was using a TDK Silver key I had spare at home, but this was a fairly reliable key, and also not used often.<br /> 3. Common ssh and shell command familiarity, editing files with vi, General understanding of VMware ESXi installation processes, etc.</p> <p>Sorry for the photos instead of screenshots. I will try and update these with better screenshots in future.</p> <p>First thing is first, I went into the IMM bios for this server and changed the boot order as per the photo.<br /> CD/DVD first, then USB second, and Hard Disks later. While my server has 2x 15K 300GB disks in a Raid 1 mirror, these can’t be used as the VMware Hypervisor install location, as the Raid card is no longer supported in ESXi 7.0 HCL.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_203049-1024x692.jpg" alt="" /></p> <p>After this is completed, you can then commence the installation, as there is no Physical DVD/CDRom on the server, I am mounting the ISO via my Windows 10 Virtual Machine Desktop. Historically for these legacy IBM servers, the best solution is to use Windows and use Internet Explorer as the browser for connecting to the IMM IP address, make sure you add the IP address to the Trusted Sites list in IE, and run a version of Java like 1.7.0_60. I also like to add the IP address for the IMM to the Java Exception Site List.</p> <p>It is a good time to insert your USB key into the server now. It will be formatted by the ESXi installation, so no need to prep it ahead of time. Just make sure it doesn’t have any important files first.</p> <p>OK, but if you have made is this far you should be ready to boot the machine, and boot from the ISO or Physical CD of VMware Hypervisor v7.0.x, but you will need to stop the booting of the ESXi Installer via the “SHIFT and O” thats o for oh, not a zero. You should see the prompt for this, and you need to run it, else the installer will halt and error out anyway, so if you missed the “SHIFT + O” prompt, reboot the server.</p> <p>Once you get to the prompt, you will need to manually add the text <code class="language-plaintext highlighter-rouge">allowLegacyCPU=true</code> to the command, after the runweasel text as below. It’s also very important to type it exactly, as this is case-sensitive. Many thanks to William Lam for this key ingredient. He shared this post <a href="https://www.virtuallyghetto.com/2020/04/quick-tip-allow-unsupported-cpus-when-upgrading-to-esxi-7-0.html">here:</a> and it is well worth a read.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_221438-1024x821.jpg" alt="" /></p> <p>Now the installation should commence…</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_221629-1024x811.jpg" alt="install proceeding" /></p> <p>When prompted as to the location for the installation, you should see the option to install to your USB flash drive. If you don’t see it under Local: then you may need to try a different USB flash drive.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_221808-1024x815.jpg" alt="usb format" /></p> <p>You will likely be warned about incompatible hardware in the server. Hit Enter to continue, and please note again, this work around should never be used for critical systems!</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_221947-1024x793.jpg" alt="warnings" /></p> <p>Now we are prompted to confirm the installation to the USB flash drive, and the partitions will be lost. Hit F11!</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_222007-1024x786.jpg" alt="confirming install" /></p> <p>Now, you can complete the installation and set a management IP address, and any other settings as you normally would.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_222606-1024x818.jpg" alt="completed install" /></p> <p>On the next boot up after the install, you will likely need to insert the “allowLegacyCPU=true” option one more time upon boot, using the “SHIFT + O” keys to modify the prompt.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_222935-1024x821.jpg" alt="shift-o" /></p> <p>Now ESXi should boot up and you all good, but wait theres one more step to ensuring you don’t need to modify the boot command prompt every time you restart the host. Read on !</p> <p>So we need to edit the boot.cfg file to achieve this. So you need to start the TSM and TSM-SSH services to be able to connect via ssh to your ESXi server. A default install, will have these services set to stopped. So login to your ESXi host via the Management IP address you set and select the Manage Host option on the left menu, then Services tab, and start the services. Here is the before.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/esxi-services-1024x267.jpg" alt="stopped services" /></p> <p>Here is the after.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/esxi-services-on-1024x259.jpg" alt="services started" /></p> <p>Now you can ssh in as root, using the password you set during the installation.</p> <p>In my following screenshots I looked for these files, and then edited them manually. The best way is to run a shell command <code class="language-plaintext highlighter-rouge">find / -name "boot.cfg"</code> and then modify both boot.cfg files with appending the allowLegacyCPU=true to the kernelopt= line. See my screenshots below. The first one, I found one file and edited it, then checked it with <code class="language-plaintext highlighter-rouge">cat boot.cfg</code> to make sure it was good.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_224228-1024x755.jpg" alt="boot edit" /></p> <p>Then I used the find command to see where the other boot.cfg file was. Now these files, should actually just be in the /bootbank and /altbootbank symlinked directories. I wanted to be sure, so used find instead. It might not be also required to edit both bootbanks.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_224404-1024x679.jpg" alt="second edit" /></p> <p>Lastly, now check both files are updated, and give the ESXi server a reboot from the ESXi UI, and test that the server comes back up after a reboot without any user input.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/20200701_224423-1024x795.jpg" alt="last check" /></p> <p>And here is the money shot. ESXi 7.0 running on a Legacy server, ready for some testing.</p> <p><img src="https://copydata.tips/wp-content/uploads/2020/07/finale-1024x540.jpg" alt="esx7 on a legacy m3" /></p> <p>But again, this is unsupported by VMware. So please do not bother them if it does not work for you. You will not get any support when using this procedure.</p> <p>Cheers.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
